\documentclass[a4paper,12pt]{article}
\usepackage[koi8-r]{inputenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{mathtext}
\usepackage[T2A]{fontenc}
\usepackage{array}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage[justification=centering,labelsep=period]{caption}
\usepackage{indentfirst}
\usepackage[pdftex]{graphicx,color}
\usepackage{textcomp}
\usepackage{gnuplot-lua-tikz}
\usepackage{tikz}
\usepackage[europeanresistors,americaninductors]{circuitikz}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[top=20mm,bottom=20mm,left=20mm,right=20mm]{geometry}



% \renewcommand{\captionlabeldelim} {.}

\makeatletter
\renewcommand\@biblabel[1]{#1.}
\makeatother

\unitlength=1mm

\usepackage{listings} %% собственно, это и есть пакет listings
% \usepackage{caption}
\DeclareCaptionFont{white}{\color{white}} %% это сделает текст заголовка белым
%% код ниже нарисует серую рамочку вокруг заголовка кода.
\DeclareCaptionFormat{listing}{\colorbox{white}{\parbox{\textwidth}{#1#2#3}}}
% \captionsetup[lstlisting]{format=listing,labelfont=black,textfont=black}
\renewcommand{\lstlistingname}{Листинг}


\begin{document}


\usetikzlibrary{arrows}
\usetikzlibrary{circuits}
\usetikzlibrary{circuits.ee}
\usetikzlibrary{circuits.ee.IEC}
\usetikzlibrary{circuits.logic.IEC}

\lstset{ %
 language=Bash,                 % выбор языка для подсветки (здесь это С)
 basicstyle=\small\ttfamily, % размер и начертание шрифта для подсветки кода
 numbers=left,               % где поставить нумерацию строк (слева\справа)
 numberstyle=\tiny,           % размер шрифта для номеров строк
 stepnumber=1,                   % размер шага между двумя номерами строк
 numbersep=5pt,                % как далеко отстоят номера строк от
 % подсвечиваемого кода
 backgroundcolor=\color{white}, % цвет фона подсветки - используем
 showspaces=false,            % показывать или нет пробелы специальными
% отступами
 showstringspaces=false,      % показывать или нет пробелы в строках
 showtabs=false,             % показывать или нет табуляцию в строках
 frame=single,              % рисовать рамку вокруг кода
 tabsize=2,                 % размер табуляции по умолчанию равен 2 пробелам
 captionpos=t,              % позиция заголовка вверху [t] или внизу [b] 
 breaklines=true,           % автоматически переносить строки (да\нет)
% wordwrap=true,
 breakatwhitespace=false, % переносить строки только если есть пробел
 escapeinside={\%*}{*)}   % если нужно добавить комментарии в коде
 }


 
% \cygfamily

\author{Кузнецов В.В., ассистент кафедры ЭИУ1-КФ}
\title{Лабораторная работа \No 6 по курсу <<Радиотехнические устройства и
системы>> \\
Моделирование S-параметров}
\maketitle


\section{Цель работы}

Цель данного лабораторной работы --- изучение моделирования S-параметров в
программе Qucs. 

Данная программа основана на вновь разработанном ядре схемотехнического
моделирования (разработка совместно с Берлинским институтом высокочастотной
техники) и работает под управлением операционных систем (ОС) Linux и Windows. В
данной программе возможно моделирование аналоговых и цифровых схем,
моделирование на постоянном и переменном токе и моделирование переходного
процесса. Недостатком программы является разделение аналогового и  цифрового
моделирования.

Родной операционной системой для Qucs является Linux, и при работе на этой
системы следует ожидать наибольшей производительности. Настоятельно
рекомендуется использовать для работы программы ОС Linux.

Версию Qucs для Linux можно установить в один клик, используя пакетный
менеджер, а версию для Windows можно скачать бесплатно с сайта разработчика
\url{http://qucs.souceforge.net}.

\section{Краткое введение в анализ высокочастотных схем}

\subsection{S-параметры четырёхполюсника}

Четырёхполюсником является любая электронная схема, имеющая один вход и один
выход: усилитель, фильтр, аттенюатор. Активный четырёхполюсник содержит
источники питания и может усиливать входной сигнал. Активный четырёхполюсник
как правило содержит биполярный или полевой транзистор, интегральный
операционный усилитель и т.п. схемы. Пассивный четырёхполюсник не имеет
источников питания. и не может усиливать сигнал. К пассивным четырёхполюсникам
относятся LC- и RC- фильтры которые содержат только индуктивность, ёмкость и
сопротивление.

В радиотехнике для того, чтобы охарактеризовать четырёхполюсник применяется
матрица S-параметров, или иначе матрица рассеяния. S-параметры устанавливают
связь между нормированными амплитудами напряжения и тока на входе и на выходе
четырёхполюсника. Если вход четырёхполюсника подключен к источнику переменного
тока (генератору колебаний) с некоторым выходным сопротивлением $Z_1$, то часть
энергии от источника передаётся на вход, а часть --- отражается от входа. Пусть
нормированная амплитуда падающей на вход волны равна $a_1$, а отражённой волны
$b_1$.

Такое же рассуждение справедливо и для выхода четырёхполюсника, к которому
подключена нагрузка с сопротивлением $Z_2$. Часть энергии, поступающей с выхода
четырёхполюсника, поглощается нагрузкой, а часть энергии --- отражается от неё
и поступает обратно в четырёхполюсник. Пусть нормированная амплитуда падающей на
нагрузку волны равна $a_2$, а отражённой от нагрузки волны $b_2$.

Нормированные амплитуды падающей и отражённой волны на входе и на выходе свзаны
через матрицу рассеяния:


\begin{eqnarray}
 b_1&=&S_{11}a_1+S_{12}a_2 \\
 b_2&=&S_{21}a_1+S_{22}a_2 
\end{eqnarray}


Физический смысл S-параметров следующий:

$S_{11}$ --- коэффициент отражения $\Gamma_1$ от входа четырёхполюсника.
Показывает степень согласования между источником входного сигнала (генератором
колебаний) и входными цепями четырёхполюсника. Если $S_{11}=0$, то вся энергия
от источника входного сигнала проходит на вход четырёхполюсника без отражения.

$S_{12}$ --- коэффициент обратной передачи. Показывает степень передачи
энергии с выхода четырёхполюсника на вход. Характеризует степень развязки между
входом и выходом, что показывает устойчивость активных четырёхполюсников.

$S_{21}$ --- коэффициент передачи. Равен коэффициенту усиления по мощности
четырёхполюсника. Для активных четырёхполюсников может быть больше единицы, а
для пассивных --- всегда меньше единицы.

$S_{22}$ --- коэффициент отражения $\Gamma_2$ от нагрузки. Показывает степень
передачи энергии с выхода в нагрузку. Если $S_{22}=0$, то вся энергия с выхода
четырёхполюсника поглощается нагрузкой без отражения. 

Для пассивных четырёхполюсников всегда $S_{21}=S_{12}$ и $S_{11}=S_{22}$, так
как внутрь четырёхполюсника не поступает дополнительная энергия от источников
питания. 

\subsection{Коэффициент стоячей волны --- КСВ}

Коэффициент стоячей волны (КСВ) ($\mbox{SWR}$ --- Standing wave ratio)
показывает степень согласования генератора с нагрузкой. КСВ всегда больше
единицы. Оптимальным значением является SWR=1. При этом вся энергия генератора
поглощается нагрузкой. Если $\mbox{SWR}>1$, то часть энергии отражается от
нагрузки и направляется в генератор. Эта энергия может вывести генератор из
строя. 

КСВ вычисляется через коэффициент отражения $\Gamma$, который определяется
через амплитуды падающей $U_{пад}$ и отражённой $U_{отр}$ волны. Эти амплитуды
можно измерить при помощи направленных ответвителей. Прибор для измерения КСВ
называется КСВ-метром.

\begin{equation}
 \Gamma = \frac{U_{отр}}{U_{пад}}
\end{equation}

\begin{equation}
 \mbox{SWR}=\frac{1+\Gamma}{1-\Gamma} \label{swr}
\end{equation}

КСВ можно вычислить и зная выходное сопротивление генератора $Z_{вых}$ и
сопротивление нагрузки $Z_н$. В этом случае коэффициент отражения вычисляется по
следующей формуле:

\begin{equation}
 \Gamma=\left|\frac{Z_н-Z_{вых}}{Z_н+Z_{вых}}\right|
 \end{equation}

 Вычисленный по указанной формуле коэффициент отражения  затем подставляется в
формулу (\ref{swr}) и вычисляется КСВ.

\section{Расчёт S-параметров пассивного четырёхполюсника}

\subsection{Расчёт П-контура}

Рассмотрим пример применения S-параметров при расчёте пассивных схем. Одной из
таких схем является П-контур, применяемый для согласования выходного каскада
передатчика с антенной, каскадов передатчика между собой и т.п.

Выходное сопротивление $R_0$ транзисторного усилителя мощности (УМ) передатчика
составляет менее 10 Ом, а лампового --- свыше 2000 Ом. Сопротивление $R_a$
антенны, которая подключается к выходу УМ всегда равно 50 или 75 Ом. Если
подключить антенну к выходу УМ напрямую, то из-за того что входное сопротивление
антенны несогласованно с выходным сопротивлением передатчика, происходит
отражение мощности от антенны и в эфир излучается неполная мощность передатчика.
Для устранения этого явления нужно согласовать антенну и выходной каскад УМ. Для
этой цели применяется в том числе П-контур (схема --- рис.\ref{p-kont}). 

\begin{figure}[!h]
\begin{center}
\begin{tikzpicture}[circuit ee IEC]
\node (C1) [point up, capacitor, info=$C_1$] at (0,1) {};
\node (gnd1) [point down,ground] at (0,0) {};
\node (L) [inductor, info=$L$] at (1.5,2) {};
\node (C2) [point up, capacitor, info=$C_2$] at (3,1) {};
\node (gnd2) [point down,ground] at (3,0) {};
\node (p1) [contact] at (3,2) {};
\node (p2) [contact] at (0,2) {};
\draw (gnd1) -- (C1) |- (L) -| (C2) -- (gnd2);
\draw [-latex] (p2) -- ++(-1,0) node [anchor=east] {Вход $R_0$};
\draw [-latex] (p1) -- ++(1,0) node [anchor=west] {Выход $R_a$};
\end{tikzpicture}
\end{center}
\caption{Схема электрическая принципиальная П-контура}\label{p-kont}
\end{figure}

Чтобы рассчитать П-контур, нужно знать выходное сопротивление оконечного
каскада УМ $R_0$, сопротивление антенны $R_a$ (обычно 50 или 75 Ом), рабочую
частоту $f_0$ и добротность $Q$ (обычно принимают $Q=10-20$).

Определяют средние значения сопротивления нагрузки $\rho$:

\begin{equation}
 \rho = \sqrt{R_0 R_a} \label{rho}
\end{equation}

И реактивные сопротивления конденсаторов $X_{C1}$ и $X_{C2}$ и катушки $X_{L}$:

\begin{equation}
 X_{C1}=-\frac{\rho + R_0}{Q}
\end{equation}

\begin{equation}
 X_{C2}=-\frac{\rho + R_а}{Q}
\end{equation}

\begin{equation}
 X_{L}=-(X_{C1}+X_{C2})
\end{equation}

Затем, зная реактивные сопротивления, рассчитывают индуктивность и ёмкость для
рабочей частоты П-контура $f_0$:

\begin{equation}
 C=-\frac{1}{2\pi f_0 X_{C}} \label{xc}
\end{equation}

\begin{equation}
 L=\frac{X_L}{2\pi f_0} \label{xl}
\end{equation}

% Для примера рассчитаем П-контур для согласования выхода лампового передатчика с
% выходным сопротивлением $R_0=2000\,Ом$ с антенной со входным сопротивлением
% $R_а=50\,Ом$. Добротность П-контура задаём равной $Q=16$.

% Получаем по формуле (\ref{rho}):

% $$\rho=\sqrt{2000\,Ом \cdot 50\,Ом}=316.3\,Ом$$

% Реактивные сопротивления конденсаторов:
% $$X_{C1}=-\frac{316.3 + 2000}{16}=-144.78 Ом$$

% $$X_{C2}=-\frac{316.3 + 50}{16}=-22.89 Ом$$

% Реактивной сопротивление катушки:

% $$X_{L}=-((-22.89 Ом) +(-144.78 Ом) )=167.67 Ом$$

% Индуктивность катушки и ёмкость конденсаторов находим из формул (\ref{xc}) и
% (\ref{xl}).

\subsection{Моделирование П-контура}

Для примера промоделируем П-контур, предназначенный для согласования выхода
ампового передатчика с выходным сопротивлением $R_0=2000\,Ом$ с антенной со
входным сопротивлением $R_а=50\,Ом$.

Сначала собираем схему, показанную на рис.\ref{p-kont-qucs}. На схеме размещаем
два источника питания (по входу и по выходу П-контура). Оба имеют частоту 7 МГц
и уровень сигнала +20дБмВт. Источник на входе П-контура имеет выходной импеданс
2000 Ом, а на выходе П-контура 50 Ом.

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=0.6\textwidth]{Lab6ris/P-kont.pdf}
\end{center}
\caption{Схема П-контура в программе Qucs}\label{p-kont-qucs}
\end{figure}

На схеме размещён компонент SP1, который отвечает за моделирование
S-параметров. Установка параметров этого вида моделирования напоминает
параметры для моделирования на переменном токе (AC-analisys). Параметры
моделирования для нашего случая показаны на рис.\ref{s-par}.

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=0.6\textwidth]{Lab6ris/S-param.png}
\end{center}
\caption{Установки для моделирования S-параметров}\label{s-par}
\end{figure}

Нам нужно рассчитать КСВ П-контура по входу. Для этого служит компонент
Уравнение1 (см. рис.\ref{p-kont}). Чтобы рассчитать КСВ по коэффициенту
отражения, служит функция \verb|rtoswr()|.  Коэффициент отражения по входу
равен параметру $S_{11}$, поэтому в качестве параметра передаём функции
\verb|S[1,1]|. 

Коэффициент передачи \verb|K| схемы соответствует параметру $S_{21}$,
выраженному в децибелах.

Запускаем моделирование нажатием на клавишу F2, переходим на страницу просмотра
и строим графики зависимости S-параметров от частоты. 

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=\textwidth]{Lab6ris/P-kont-mod.pdf}
\end{center}
\caption{Результаты моделирования П-контура}
\end{figure}

Из графиков видим, что на резонансной частоте П-контура (7 МГц) коэффициент
отражения $S_{11}$ минимален (приближается к нулю), а КСВ приближается к
единице, то есть отражённая волна отсутствует и обеспечивается согласование
передатчика с антенной. Коэффициент передачи $K=S_{21}$ на этой частоте
максимален. Вся мощность от передатчика проходит в антенну. 

Так как П-контур является пассивным четырёхполюсником, то $S_{11}=S_{21}$ и
$S_{21}=S_{12}$.

\textbf{Задание}. Установить импеданс антенны равным 75 Ом и подбором
ёмкости конденсаторов С1 и С2 обеспечить согласование (КСВ=1) на частоте 7 МГц.
Учесть, что конденсатор С1 сдвигает резонансную частоту, а конденсатор С2
изменяет КСВ.

\section{Расчёт S-параметров активного четырёхполюсника}

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=\textwidth]{Lab6ris/RF-ampl.pdf}
\end{center}
\caption{Схема широкополосного усилителя ВЧ}
\end{figure}


\section{Заключение}

В результате выполнения лабораторной работы произведен анализ работы
амплитудного детектора и балансного смесителя в программе Qucs. Произведён
анализ условий балансировки диодного кольцевого смесителя.

\end{document}
